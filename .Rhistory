x = "Humedal o buffer",
y = "NDVI",
fill = "Periodos de análisis") +
theme_minimal() +
scale_fill_manual(values = c("1999_2010" = "#DEB887", "2011_2021" = "#87CEFF")) +
facet_wrap(~ year_periods)
datos <-read_excel("Excel/puntos_hic_zonas_naturales.xlsx", sheet = 1)
datos <-read_excel("Excel/puntos_hic_zonas_naturales.xlsx", sheet = 1)
# Categorizar como factor
#datos <- subset(datos, MUCVA_ZONAS_NAT_T_ESPECIFICAS != "Mares y océanos") #Porque no tienen HIC aunque deberían
datos[2:9] <- lapply(datos[2:9], as.factor)
datos$CODIGO_UE2 <- lapply(datos$CODIGO_UE2, as.factor)
datos$CODIGO_UE3 <- lapply(datos$CODIGO_UE3, as.factor)
datos$CODIGO_UE4 <- lapply(datos$CODIGO_UE4, as.factor)
datos[18:33] <- lapply(datos[18:33], as.factor)
datos$PRESENCIA_ZONA_NAT<- lapply(datos$PRESENCIA_ZONA_NAT, as.factor)
datos$MUCVA_ZONAS_NAT_T_ESPECIFICAS<- lapply(datos$MUCVA_ZONAS_NAT_T_ESPECIFICAS, as.factor)
# Deshacer lista
datos$CODIGO_UE2<-unlist(datos$CODIGO_UE2)
datos$CODIGO_UE3<-unlist(datos$CODIGO_UE3)
datos$CODIGO_UE4<-unlist(datos$CODIGO_UE4)
datos$PRESENCIA_ZONA_NAT<-unlist(datos$PRESENCIA_ZONA_NAT)
datos$MUCVA_ZONAS_NAT_T_ESPECIFICAS<-unlist(datos$MUCVA_ZONAS_NAT_T_ESPECIFICAS)
# Sale diferencia significativa (***) en función de ENP
table(datos$PRESENCIA_HIC,datos$ENP)
barplot(table(datos$PRESENCIA_HIC,datos$FIGURA),
las=2,
legend.text = unique(datos$PRESENCIA_HIC),
args.legend = list(x = "top"),
ylab="Puntos de análisis (nº)",
main = "Presencia de HIC en función de la figura de protección")
barplot(table(datos$PRESENCIA_HIC,datos$ENP),
las=2,
legend.text = unique(datos$PRESENCIA_HIC),
args.legend = list(x = "top"),
ylab="Puntos de análisis (nº)",
main = "Presencia de HIC en función de la figura de protección")
#¿El tipo de propiedad, el humedal o si hay zona natural en 1984 y el tipo de uso del suelo repercuten en si hay HIC en 2020 o no?
#...SIN INTERACCIÓN:
modelo_glm2 <- glm(PRESENCIA_HIC ~ MUCVA_ZONAS_NAT_T_ESPECIFICAS+NOMBRE_HUM+PRESENCIA_ZONA_NAT, family = binomial, data = datos)
barplot(table(datos$PRESENCIA_HIC,datos$ENP),
las=2,
legend.text = unique(datos$PRESENCIA_HIC),
args.legend = list(x = "topleft"),
ylab="Puntos de análisis (nº)",
main = "Presencia de HIC en función de la figura de protección")
barplot(table(datos$PRESENCIA_HIC,datos$ENP),
las=2,
legend.text = unique(c("Presencia", "Ausencia")),
args.legend = list(x = "topleft"),
ylab="Puntos de análisis (nº)",
main = "Presencia de HIC en función de la figura de protección")
barplot(table(datos$PRESENCIA_HIC,datos$ENP),
las=2,
legend.text = unique(c("Presencia HIC", "Ausencia HIC")),
args.legend = list(x = "topleft"),
ylab="Puntos de análisis (nº)",
main = "Presencia de HIC en función de la figura de protección")
?barplot
barplot(table(datos$PRESENCIA_HIC,datos$FIGURA),
las=2,
legend.text = unique(datos$PRESENCIA_HIC),
args.legend = list(x = "top"),
ylab="Puntos de análisis (nº)",
main = "Presencia de HIC en función de la figura de protección")
barplot(table(datos$PRESENCIA_HIC,datos$FIGURA),
las=2,
legend.text = unique(c("Presencia HIC", "Ausencia HIC")),
args.legend = list(x = "top"),
ylab="Puntos de análisis (nº)",
main = "Presencia de HIC en función de la figura de protección")
datos$PRESENCIA_HIC
barplot(table(datos$PRESENCIA_HIC,datos$FIGURA),
las=2,
legend.text = unique(datos$PRESENCIA_HIC),
args.legend = list(x = "top"),
ylab="Puntos de análisis (nº)",
main = "Presencia de HIC en función de la figura de protección")
barplot(table(datos$PRESENCIA_HIC,datos$FIGURA),
las=2,
legend.text = unique(c("Ausencia HIC","Presencia HIC")),
args.legend = list(x = "top"),
ylab="Puntos de análisis (nº)",
main = "Presencia de HIC en función de la figura de protección")
barplot(table(datos$PRESENCIA_HIC,datos$FIGURA),
las=2,
legend.text = unique(c("Ausencia HIC","Presencia HIC")),
args.legend = list(x = "top"),
ylab="Puntos de análisis (nº)",
main = "Presencia de HIC en función de la figura de protección")
barplot(table(datos$PRESENCIA_HIC,datos$ENP),
las=2,
legend.text = unique(c("Ausencia HIC","Presencia HIC")),
args.legend = list(x = "topleft"),
ylab="Puntos de análisis (nº)",
main = "Presencia de HIC en función de la figura de protección")
ggplot(datos.p, aes(x = wetland_or_buffer, y = ndvi_periods, fill = year_periods)) +
geom_boxplot() +
labs(title = "Relación entre NDVI y situación con respecto al humedal por periodos",
x = "Humedal o buffer",
y = "NDVI",
fill = "Periodos de análisis") +
theme_minimal() +
scale_fill_manual(values = c("1999_2010" = "#DEB887", "2011_2021" = "#87CEFF")) +
facet_wrap(~ year_periods)
datos <-read_excel("Excel/LSWI_zones_hum_buf.xlsx", sheet=1)
datos.p <-read_excel("Excel/LSWI_zones_hum_buf.xlsx", sheet=2)
# GRÁFICO WETLAND_OR_BUFFER LSWI
library(ggplot2)
# Crear un gráfico de cajas para mostrar la relación
ggplot(datos.p, aes(x = wetland_or_buffer, y = lswi_periods, fill = year_periods)) +
geom_boxplot() +
labs(title = "Relación entre LSWI y situación con respecto al humedal por periodos",
x = "Humedal o buffer",
y = "LSWI",
fill = "Periodos de análisis") +
theme_minimal() +
scale_fill_manual(values = c("1999_2010" = "#DEB887", "2011_2021" = "#87CEFF")) +
facet_wrap(~ year_periods)
ggplot(datos.p, aes(x = wetland_or_buffer, y = ndvi_periods, fill = year_periods)) +
geom_boxplot() +
labs(title = "Relación entre NDVI y situación con respecto al humedal por periodos",
x = "Humedal o buffer",
y = "NDVI",
fill = "Periodos de análisis") +
theme_minimal() +
scale_fill_manual(values = c("1999_2010" = "#DEB887", "2011_2021" = "#87CEFF")) +
facet_wrap(~ year_periods)
ggplot(datos.p, aes(x = protection_yes_no, y = ndvi_periods, fill = year_periods)) +
geom_boxplot() +
labs(title = "Relación entre NDVI y situación con respecto al humedal por periodos",
x = "Humedal o buffer",
y = "NDVI",
fill = "Periodos de análisis") +
theme_minimal() +
scale_fill_manual(values = c("1999_2010" = "#DEB887", "2011_2021" = "#87CEFF")) +
facet_wrap(~ year_periods)
ggplot(datos.p, aes(x = protection_yes_no, y = ndvi_periods, fill = year_periods)) +
geom_boxplot() +
labs(title = "Relación entre NDVI y situación con respecto al humedal por periodos",
y = "NDVI",
fill = "Periodos de análisis") +
theme_minimal() +
scale_fill_manual(values = c("1999_2010" = "#DEB887", "2011_2021" = "#87CEFF")) +
facet_wrap(~ year_periods)
median(datos.p$protection_yes_no)
count(datos.p$protection_yes_no==0)
sum(datos.p$protection_yes_no)
summary(datos.p$protection_yes_no)
datos.pw <- pivot_wider(datos.p, names_from=year_periods, values_from = c(lswi_periods,ndvi_periods))
View(datos.pw)
datos <-read_excel("Excel/Resultados_puntos_analisis.xlsx", range = "A1:S2081")
head(datos)
df_area_usos84 <-read_excel("Resultados_puntos_analisis.xlsx", sheet = 2)
datos <-read_excel("Excel/Resultados_puntos_analisis.xlsx", range = "A1:S2081")
################################################################################
# Análisis exploratorio de los datos: gráficas #################################
pie(table(datos$COMPARACION))
datos <-read_excel("Excel/Resultados_puntos_analisis.xlsx", range = "A1:S2081")
View(datos)
colnames(datos)
table(datos$COMPARACION)
barplot(table(datos$COMPARACION))
# Modelo lineal generalizado binomial ##########################################
#¿Que esté protegido y su localización con respecto a la costa repercuten en si hay HIC en 2020 o no?
modelo_glm <- glm(PRESENCIA_HIC~FIGURA, family = binomial, data=datos)
# Leer los archivos
setwd("D:/Escritorio/TFM/rTFM")
datos <-read_excel("Excel/puntos_hic_zonas_naturales.xlsx", sheet = 1)
# Categorizar como factor
#datos <- subset(datos, MUCVA_ZONAS_NAT_T_ESPECIFICAS != "Mares y océanos") #Porque no tienen HIC aunque deberían
datos[2:9] <- lapply(datos[2:9], as.factor)
datos$CODIGO_UE2 <- lapply(datos$CODIGO_UE2, as.factor)
datos$CODIGO_UE3 <- lapply(datos$CODIGO_UE3, as.factor)
datos$CODIGO_UE4 <- lapply(datos$CODIGO_UE4, as.factor)
datos[18:33] <- lapply(datos[18:33], as.factor)
datos$PRESENCIA_ZONA_NAT<- lapply(datos$PRESENCIA_ZONA_NAT, as.factor)
datos$MUCVA_ZONAS_NAT_T_ESPECIFICAS<- lapply(datos$MUCVA_ZONAS_NAT_T_ESPECIFICAS, as.factor)
# Deshacer lista
datos$CODIGO_UE2<-unlist(datos$CODIGO_UE2)
datos$CODIGO_UE3<-unlist(datos$CODIGO_UE3)
datos$CODIGO_UE4<-unlist(datos$CODIGO_UE4)
datos$PRESENCIA_ZONA_NAT<-unlist(datos$PRESENCIA_ZONA_NAT)
datos$MUCVA_ZONAS_NAT_T_ESPECIFICAS<-unlist(datos$MUCVA_ZONAS_NAT_T_ESPECIFICAS)
# Modelo lineal generalizado binomial ##########################################
#¿Que esté protegido y su localización con respecto a la costa repercuten en si hay HIC en 2020 o no?
modelo_glm <- glm(PRESENCIA_HIC~FIGURA, family = binomial, data=datos)
Anova(modelo_glm)
summary(modelo_glm) #ENP pendiente negativa
modelo_glm <- glm(PRESENCIA_ZONA_NAT~FIGURA, family = binomial, data=datos)
Anova(modelo_glm)
summary(modelo_glm) #ENP pendiente negativa
colnames(datos)
datos <-read_excel("Excel/puntos_hic_zonas_naturales.xlsx", sheet = 1)
# Categorizar como factor
#datos <- subset(datos, MUCVA_ZONAS_NAT_T_ESPECIFICAS != "Mares y océanos") #Porque no tienen HIC aunque deberían
datos[2:9] <- lapply(datos[2:9], as.factor)
datos$CODIGO_UE2 <- lapply(datos$CODIGO_UE2, as.factor)
datos$CODIGO_UE3 <- lapply(datos$CODIGO_UE3, as.factor)
datos$CODIGO_UE4 <- lapply(datos$CODIGO_UE4, as.factor)
datos[18:33] <- lapply(datos[18:33], as.factor)
datos$PRESENCIA_ZONA_NAT<- lapply(datos$PRESENCIA_ZONA_NAT, as.factor)
datos$MUCVA_ZONAS_NAT_T_ESPECIFICAS<- lapply(datos$MUCVA_ZONAS_NAT_T_ESPECIFICAS, as.factor)
# Deshacer lista
datos$CODIGO_UE2<-unlist(datos$CODIGO_UE2)
datos$CODIGO_UE3<-unlist(datos$CODIGO_UE3)
datos$CODIGO_UE4<-unlist(datos$CODIGO_UE4)
datos$PRESENCIA_ZONA_NAT<-unlist(datos$PRESENCIA_ZONA_NAT)
datos$MUCVA_ZONAS_NAT_T_ESPECIFICAS<-unlist(datos$MUCVA_ZONAS_NAT_T_ESPECIFICAS)
modelo_lm <- lm(datos$`TIPO_DE_CAMBIO`)
modelo_lm <- lm(`TIPO_DE_CAMBIO` ~ FIGURA, data=datos)
modelo_lm <- lm(TIPO_DE_CAMBIO ~ FIGURA, data=datos)
modelo_lm <- lm(TIPO_DE_CAMBIO ~ ENP, data=datos)
View(datos)
datos[36] <- lapply(datos[36], as.factor)
modelo_lm <- lm(TIPO_DE_CAMBIO ~ ENP, data=datos)
summary(modelo_lm) #
modelo_lm <- lm(TIPO_DE_CAMBIO ~ ENP, data=datos)
summary(modelo_lm) #
datos$TIPO_DE_CAMBIO<- lapply(datos$TIPO_DE_CAMBIO, as.factor)
modelo_lm <- lm(TIPO_DE_CAMBIO ~ ENP, data=datos)
datos$TIPO_DE_CAMBIO<-unlist(datos$TIPO_DE_CAMBIO)
modelo_lm <- lm(TIPO_DE_CAMBIO ~ ENP, data=datos)
is.factor(datos$TIPO_DE_CAMBIO)
datos$ENP<- lapply(datos$ENP, as.factor)
modelo_lm <- lm(TIPO_DE_CAMBIO ~ ENP, data=datos)
datos$ENP<-unlist(datos$ENP)
modelo_lm <- lm(TIPO_DE_CAMBIO ~ ENP, data=datos)
modelo_lm <- lm(ENP ~ TIPO_DE_CAMBIO, data=datos)
datos <-read_excel("Excel/puntos_hic_zonas_naturales.xlsx", sheet = 1)
# Categorizar como factor
#datos <- subset(datos, MUCVA_ZONAS_NAT_T_ESPECIFICAS != "Mares y océanos") #Porque no tienen HIC aunque deberían
datos[2:9] <- lapply(datos[2:9], as.factor)
datos$CODIGO_UE2 <- lapply(datos$CODIGO_UE2, as.factor)
datos$CODIGO_UE3 <- lapply(datos$CODIGO_UE3, as.factor)
datos$CODIGO_UE4 <- lapply(datos$CODIGO_UE4, as.factor)
datos[18:33] <- lapply(datos[18:33], as.factor)
datos$TIPO_DE_CAMBIO<- lapply(datos$TIPO_DE_CAMBIO, as.factor)
datos$PRESENCIA_ZONA_NAT<- lapply(datos$PRESENCIA_ZONA_NAT, as.factor)
datos$MUCVA_ZONAS_NAT_T_ESPECIFICAS<- lapply(datos$MUCVA_ZONAS_NAT_T_ESPECIFICAS, as.factor)
# Deshacer lista
datos$CODIGO_UE2<-unlist(datos$CODIGO_UE2)
datos$CODIGO_UE3<-unlist(datos$CODIGO_UE3)
datos$CODIGO_UE4<-unlist(datos$CODIGO_UE4)
datos$PRESENCIA_ZONA_NAT<-unlist(datos$PRESENCIA_ZONA_NAT)
datos$TIPO_DE_CAMBIO<-unlist(datos$TIPO_DE_CAMBIO)
datos$MUCVA_ZONAS_NAT_T_ESPECIFICAS<-unlist(datos$MUCVA_ZONAS_NAT_T_ESPECIFICAS)
modelo_lm <- lm(ENP ~ TIPO_DE_CAMBIO, data=datos)
################################################################################
# Análisis exploratorio de los datos: gráficas #################################
pie(table(datos$COMPARACION))
?pie
pie(table(datos$MUCVA1984)) #Usos 1984
################################################################################
# Análisis exploratorio de los datos: gráficas #################################
pie(table(datos$COMPARACION))
table(datos$COMPARACION)
pie(table(datos$TIPO_DE_CAMBIO)) #Usos 2023
pie(table(datos$TIPO_DE_CAMBIO),names=c(0_0=="s",0_1=="q",1_0=="r",1_1=="w",)) #Usos 2023
ggplot(datos, aes(x = TIPO_DE_CAMBIO)) +
geom_bar()
ggplot(datos, aes(x = TIPO_DE_CAMBIO), fill = grupo) +
geom_bar()
ggplot(datos, aes(x = TIPO_DE_CAMBIO), fill = TIPO_DE_CAMBIO) +
geom_bar()
result_area84 <- df_area_usos84 %>%
group_by(df_area_usos84$`_USOS_DEFI`) %>%
summarise(Total_Area = sum(AREA_POLIG))
result_area20 <- df_area_usos20 %>%
group_by(`_USOS_DEFI`) %>%
summarise(Total_Area = sum(AREA_POLIG))
################################################################################
################################################################################
# Agrupar por ZONA (BUFFER VS HUMEDAL) y COMPARACION (IGUAL VS DISTINTO), y contar las ocurrencias
comparacion_resumen <- datos %>%
group_by(ZONA, COMPARACION) %>%
summarize(count = n()) %>%
ungroup()
print(comparacion_resumen)
# Calcular proporciones
comparacion_proporciones <- comparacion_resumen %>%
group_by(ZONA) %>%
mutate(proporcion = count / sum(count))
print(comparacion_proporciones)
# Gráfico de barras apiladas
ggplot(comparacion_proporciones, aes(x = ZONA, y = proporcion, fill = COMPARACION)) +
geom_bar(stat = "identity") +
labs(title = "Comparación de Cambios de Uso del suelo Dentro y Fuera de Humedales",
x = "Zona (Dentro/Fuera del Humedal)", y = "Proporción") +
scale_y_continuous(labels = scales::percent_format()) +
theme_minimal()
################################################################################
# Para evaluar los cambios específicos de uso del suelo ########################
# Crear una columna que muestre el cambio de uso del suelo
data <- datos %>%
mutate(cambio_uso = paste(MUCVA1984, "a", SIOSE2020))
# Agrupar por zona y tipo de cambio de uso del suelo, y contar las ocurrencias
cambio_uso_buf_hum <- data %>%
group_by(ZONA, cambio_uso) %>%
summarize(count = n()) %>%
ungroup()
# Gráfico de barras apiladas
ggplot(comparacion_proporciones, aes(x = ZONA, y = proporcion, fill = COMPARACION)) +
geom_bar(stat = "identity") +
labs(title = "Comparación de Cambios de uso del suelo dentro y fuera de humedales",
x = "Zona (dentro/fuera del humedal)", y = "Proporción") +
scale_y_continuous(labels = scales::percent_format()) +
theme_minimal()
# Gráfico de barras apiladas
ggplot(comparacion_proporciones, aes(x = ZONA, y = proporcion, fill = COMPARACION)) +
geom_bar(stat = "identity") +
labs(title = "Comparación de cambios de uso del suelo dentro y fuera de humedales",
x = "Zona (dentro/fuera del humedal)", y = "Proporción") +
scale_y_continuous(labels = scales::percent_format()) +
theme_minimal()
# Gráfico de barras apiladas
ggplot(comparacion_proporciones, aes(x = ZONA, y = proporcion, fill = COMPARACION)) +
geom_bar(stat = "identity") +
labs(title = "Cambios de uso del suelo en función de situación con respecto al humedal",
x = "Zona (dentro/fuera del humedal)", y = "Proporción") +
scale_y_continuous(labels = scales::percent_format()) +
theme_minimal()
# Gráfico de barras apiladas
ggplot(comparacion_proporciones, aes(x = ZONA, y = proporcion, fill = COMPARACION)) +
geom_bar(stat = "identity") +
labs(title = "Cambios de uso del suelo según situación con respecto al humedal",
x = "Zona (dentro/fuera del humedal)", y = "Proporción") +
scale_y_continuous(labels = scales::percent_format()) +
theme_minimal()
# Gráfico de barras apiladas
ggplot(comparacion_proporciones, aes(x = ZONA, y = proporcion, fill = COMPARACION)) +
geom_bar(stat = "identity") +
labs(title = "Cambios de uso del suelo en función de situación con respecto al humedal",
x = "Zona (dentro/fuera del humedal)", y = "Proporción") +
scale_y_continuous(labels = scales::percent_format()) +
theme_minimal()
# Gráfico de barras apiladas
ggplot(comparacion_proporciones, aes(x = ZONA, y = proporcion, fill = COMPARACION)) +
geom_bar(stat = "identity") +
labs(title = "Cambios de uso del suelo en función de situación con respecto al humedal",
x = "Zona (dentro/fuera del humedal)", y = "Proporción") +
scale_y_continuous(labels = scales::percent_format()) +
scale_fill_manual(values = c("IGUAL" = "#DEB887", "DISTINTO" = "#87CEFF")) +
theme_minimal()
# Gráfico de barras apiladas
ggplot(comparacion_proporciones, aes(x = ZONA, y = proporcion, fill = COMPARACION)) +
geom_bar(stat = "identity") +
labs(title = "Cambios de uso del suelo en función de situación con respecto al humedal",
x = "Zona (dentro/fuera del humedal)", y = "Proporción") +
scale_y_continuous(labels = scales::percent_format()) +
scale_fill_manual(values = c("IGUAL" = "darkseagreen2", "DISTINTO" = "#BF3EFF")) +
theme_minimal()
# Gráfico de barras apiladas
ggplot(comparacion_proporciones, aes(x = ZONA, y = proporcion, fill = COMPARACION)) +
geom_bar(stat = "identity") +
labs(title = "Cambios de uso del suelo en función de situación con respecto al humedal",
x = "Zona (dentro/fuera del humedal)", y = "Proporción") +
scale_y_continuous(labels = scales::percent_format()) +
scale_fill_manual(values = c("IGUAL" = "darkolivegreen3", "DISTINTO" = "#BF3EFF")) +
theme_minimal()
# Gráfico de barras apiladas
ggplot(comparacion_proporciones, aes(x = ZONA, y = proporcion, fill = COMPARACION)) +
geom_bar(stat = "identity") +
labs(title = "Cambios de uso del suelo en función de situación con respecto al humedal",
x = "Zona (dentro/fuera del humedal)", y = "Proporción") +
scale_y_continuous(labels = scales::percent_format()) +
scale_fill_manual(values = c("IGUAL" = "darkslategray2", "DISTINTO" = "darkorchid1")) +
theme_minimal()
darkolivegreen3
# Gráfico de barras apiladas
ggplot(comparacion_proporciones, aes(x = ZONA, y = proporcion, fill = COMPARACION)) +
geom_bar(stat = "identity") +
labs(title = "Cambios de uso del suelo en función de situación con respecto al humedal",
x = "Zona (dentro/fuera del humedal)", y = "Proporción") +
scale_y_continuous(labels = scales::percent_format()) +
scale_fill_manual(values = c("IGUAL" = "darkolivegreen3", "DISTINTO" = "darkorchid1")) +
theme_minimal()
# Gráfico de barras apiladas
ggplot(comparacion_proporciones, aes(x = ZONA, y = proporcion, fill = COMPARACION)) +
geom_bar(stat = "identity") +
labs(title = "Cambios de uso del suelo en función de situación con respecto al humedal",
x = "Zona (dentro/fuera del humedal)", y = "Proporción") +
scale_y_continuous(labels = scales::percent_format()) +
scale_fill_manual(values = c("IGUAL" = "honeydew3", "DISTINTO" = "darkorchid1")) +
theme_minimal()
# Gráfico de barras apiladas
ggplot(comparacion_proporciones, aes(x = ZONA, y = proporcion, fill = COMPARACION)) +
geom_bar(stat = "identity") +
labs(title = "Cambios de uso del suelo en función de situación con respecto al humedal",
x = "Zona (dentro/fuera del humedal)", y = "Proporción") +
scale_y_continuous(labels = scales::percent_format()) +
scale_fill_manual(values = c("IGUAL" = "honeydew4", "DISTINTO" = "darkorchid1")) +
theme_minimal()
# Gráfico de barras apiladas
ggplot(comparacion_proporciones, aes(x = ZONA, y = proporcion, fill = COMPARACION)) +
geom_bar(stat = "identity") +
labs(title = "Cambios de uso del suelo en función de situación con respecto al humedal",
x = "Zona (dentro/fuera del humedal)", y = "Proporción") +
scale_y_continuous(labels = scales::percent_format()) +
scale_fill_manual(values = c("IGUAL" = "honeydew4", "DISTINTO" = "darkorchid1")) +
theme_minimal()
# Gráfico de barras apiladas
ggplot(comparacion_proporciones, aes(x = ZONA, y = proporcion, fill = COMPARACION)) +
geom_bar(stat = "identity") +
labs(title = "Cambios de uso del suelo en función de situación con respecto al humedal",
x = "Zona (dentro/fuera del humedal)", y = "Proporción") +
scale_y_continuous(labels = scales::percent_format()) +
scale_fill_manual(values = c("IGUAL" = "honeydew3", "DISTINTO" = "darkorchid1")) +
theme_minimal()
################################################################################
# Para evaluar los cambios específicos de uso del suelo ########################
# Crear una columna que muestre el cambio de uso del suelo
data <- datos %>%
mutate(cambio_uso = paste(MUCVA1984, "a", SIOSE2020))
# Ver los resultados
print(cambio_uso_buf_hum)
# Gráfico de barras apiladas por tipo de cambio
ggplot(cambio_uso_buf_hum, aes(x = ZONA, y = count, fill = cambio_uso)) +
geom_bar(stat = "identity") +
labs(title = "Cambios de Uso del suelo Dentro y Fuera de Humedales",
x = "Zona (Dentro/Fuera del Humedal)", y = "Número de Cambios") +
theme_minimal()
# Gráfico de barras agrupadas
ggplot(cambio_uso_buf_hum, aes(x = cambio_uso, y = count, fill = ZONA)) +
geom_bar(stat = "identity", position = "dodge") +
labs(title = "Cambios Específicos de Uso del suelo por Zona",
x = "Cambio de Uso del suelo", y = "Número de Cambios") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
# Resumen descriptivo
cambio_uso_buf_hum %>%
arrange(desc(count))
# Crear tabla de contingencia
tabla_contingencia_bh <- table(data$ZONA, data$cambio_uso)
# Realizar prueba de Chi-cuadrado
chi_test <- chisq.test(tabla_contingencia_bh)
print(chi_test)
# Transformar la tabla de formato largo a formato ancho
tabla_ancha <- as.data.frame(tabla_contingencia_bh) %>%
pivot_wider(names_from = Var1, values_from = Freq)
################################################################################
# Para evaluar los cambios específicos de uso del suelo ########################
# Crear una columna que muestre el cambio de uso del suelo
data <- datos %>%
mutate(cambio_uso = paste(MUCVA1984, "a", SIOSE2020))
colnames(datos)
################################################################################
# Para evaluar los cambios específicos de uso del suelo ########################
# Crear una columna que muestre el cambio de uso del suelo
data <- datos %>%
mutate(cambio_uso = paste(MUCVA_T_ES, "a", SIOSE2020))
################################################################################
# Para evaluar los cambios específicos de uso del suelo ########################
# Crear una columna que muestre el cambio de uso del suelo
data <- datos %>%
mutate(cambio_uso = paste(MUCVA_T_ES, "a", SIOSE_T_ES))
# Ver los primeros registros para confirmar
head(data)
################################################################################
# Para evaluar los cambios específicos de uso del suelo ########################
# Crear una columna que muestre el cambio de uso del suelo
data <- datos %>%
mutate(cambio_uso = paste(MUCVA_T_ES, "a", SIOSE_T_ES))
# Ver los primeros registros para confirmar
head(data)
# Agrupar por zona y tipo de cambio de uso del suelo, y contar las ocurrencias
cambio_uso_buf_hum <- data %>%
group_by(ZONA, cambio_uso) %>%
summarize(count = n()) %>%
ungroup()
# Ver los resultados
print(cambio_uso_buf_hum)
# Gráfico de barras apiladas por tipo de cambio
ggplot(cambio_uso_buf_hum, aes(x = ZONA, y = count, fill = cambio_uso)) +
geom_bar(stat = "identity") +
labs(title = "Cambios de Uso del suelo Dentro y Fuera de Humedales",
x = "Zona (Dentro/Fuera del Humedal)", y = "Número de Cambios") +
theme_minimal()
# Gráfico de barras agrupadas
ggplot(cambio_uso_buf_hum, aes(x = cambio_uso, y = count, fill = ZONA)) +
geom_bar(stat = "identity", position = "dodge") +
labs(title = "Cambios Específicos de Uso del suelo por Zona",
x = "Cambio de Uso del suelo", y = "Número de Cambios") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
################################################################################
# Para evaluar los cambios específicos de uso del suelo ########################
# Crear una columna que muestre el cambio de uso del suelo
data <- datos %>%
mutate(cambio_uso = paste(MUCVA_T_GE, "a", SIOSE_T_GE))
# Ver los primeros registros para confirmar
head(data)
# Agrupar por zona y tipo de cambio de uso del suelo, y contar las ocurrencias
cambio_uso_buf_hum <- data %>%
group_by(ZONA, cambio_uso) %>%
summarize(count = n()) %>%
ungroup()
# Ver los resultados
print(cambio_uso_buf_hum)
# Gráfico de barras apiladas por tipo de cambio
ggplot(cambio_uso_buf_hum, aes(x = ZONA, y = count, fill = cambio_uso)) +
geom_bar(stat = "identity") +
labs(title = "Cambios de Uso del suelo Dentro y Fuera de Humedales",
x = "Zona (Dentro/Fuera del Humedal)", y = "Número de Cambios") +
theme_minimal()
# Gráfico de barras agrupadas
ggplot(cambio_uso_buf_hum, aes(x = cambio_uso, y = count, fill = ZONA)) +
geom_bar(stat = "identity", position = "dodge") +
labs(title = "Cambios Específicos de Uso del suelo por Zona",
x = "Cambio de Uso del suelo", y = "Número de Cambios") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
