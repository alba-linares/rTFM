modelo_glm2 <- glm(PRESENCIA_HIC ~ PROPIEDAD + MUCVA_ZONAS_NAT_T_ESPECIFICAS + NOMBRE_HUM + PRESENCIA_ZONA_NAT,
family = binomial, data = datos)
datos[18:33] <- lapply(datos[18:33], as.factor)
#¿El tipo de propiedad, el humedal o si hay zona natural en 1984 y el tipo de uso del suelo repercuten en si hay HIC en 2020 o no?
#...SIN INTERACCIÓN:
modelo_glm2 <- glm(PRESENCIA_HIC ~ PROPIEDAD+MUCVA_ZONAS_NAT_T_ESPECIFICAS+NOMBRE_HUM+PRESENCIA_ZONA_NAT, family = binomial, data = datos)
Anova(modelo_glm2)
#...CON INTERACCIÓN: * y contrasts=list(), también he eliminado PROPIEDAD, porque no era significativo
modelo_glm2_2 <- glm(PRESENCIA_HIC ~ MUCVA_ZONAS_NAT_T_ESPECIFICAS*COD_IHA*PRESENCIA_ZONA_NAT, contrasts=list(MUCVA_ZONAS_NAT_T_ESPECIFICAS=contr.sum,COD_IHA=contr.sum), family = binomial, data = datos)
Anova(modelo_glm2_2) #tarda mucho
barplot(table(datos$PRESENCIA_HIC,datos$FIGURA),
legend=T,
legend.text = unique(datos$PRESENCIA_HIC),
args.legend = list(x = "top"),
ylab="Puntos de análisis (nº)",
main = "Presencia de HIC en función de la figura de protección",
#arrows(data_summary$mean - data_summary$sd, data_summary$mean + data_summary$sd, angle = 90, code = 3, length = 0.1, col = "black"),
#text(data_summary$mean + data_summary$sd + 0.02, labels = tukey_labels, col = "black")        # Añadir letras de Tukey
)
barplot(table(datos$PRESENCIA_HIC,datos$FIGURA),
legend=T,
legend.text = unique(datos$PRESENCIA_HIC),
args.legend = list(x = "top"),
ylab="Puntos de análisis (nº)",
main = "Presencia de HIC en función de la figura de protección"
#arrows(data_summary$mean - data_summary$sd, data_summary$mean + data_summary$sd, angle = 90, code = 3, length = 0.1, col = "black"),
#text(data_summary$mean + data_summary$sd + 0.02, labels = tukey_labels, col = "black")        # Añadir letras de Tukey
)
barplot(table(datos$PRESENCIA_HIC,datos$FIGURA),
legend=T,
legend.text = unique(datos$PRESENCIA_HIC),
args.legend = list(x = "top"),
ylab="Puntos de análisis (nº)",
main = "Presencia de HIC en función de la figura de protección")
barplot(table(datos$PRESENCIA_HIC,datos$FIGURA),
#legend=T,
legend.text = unique(datos$PRESENCIA_HIC),
args.legend = list(x = "top"),
ylab="Puntos de análisis (nº)",
main = "Presencia de HIC en función de la figura de protección")
barplot(table(datos$PRESENCIA_HIC,datos$FIGURA),
#legend=T,
legend.text = unique(datos$PRESENCIA_HIC),
args.legend = list(x = "top"),
ylab="Puntos de análisis (nº)",
main = "Presencia de HIC en función de la figura de protección")
barplot(table(datos$PRESENCIA_HIC,datos$FIGURA),
legend.text = unique(datos$PRESENCIA_HIC),
args.legend = list(x = "top"),
ylab="Puntos de análisis (nº)",
main = "Presencia de HIC en función de la figura de protección")
barplot(table(datos$PRESENCIA_HIC,datos$NOMBRE_HUM),
legend.text = unique(datos$PRESENCIA_HIC),
args.legend = list(x = "top"),
ylab="Puntos de análisis (nº)",
main = "Presencia de HIC en función de la figura de protección")
#...CON INTERACCIÓN: * y contrasts=list(), también he eliminado PROPIEDAD, porque no era significativo
modelo_glm2_2 <- glm(PRESENCIA_HIC ~ MUCVA_ZONAS_NAT_T_ESPECIFICAS*COD_IHA*PRESENCIA_ZONA_NAT, contrasts=list(MUCVA_ZONAS_NAT_T_ESPECIFICAS=contr.sum,COD_IHA=contr.sum), family = binomial, data = datos)
Anova(modelo_glm2_2) #tarda mucho
sapply(datos[1:37], function(x) length(unique(x)))
modelo_glm2 <- glm(PRESENCIA_HIC ~ PROPIEDAD + MUCVA_ZONAS_NAT_T_ESPECIFICAS + NOMBRE_HUM + PRESENCIA_ZONA_NAT,
family = binomial, data = datos)
# Asegúrate de que estas variables sean factores
datos$MUCVA_ZONAS_NAT_T_ESPECIFICAS <- as.factor(datos$MUCVA_ZONAS_NAT_T_ESPECIFICAS)
datos$COD_IHA <- as.factor(datos$COD_IHA)
datos$PRESENCIA_ZONA_NAT <- as.factor(datos$PRESENCIA_ZONA_NAT)
table(datos$MUCVA_ZONAS_NAT_T_ESPECIFICAS)  # Revisa los niveles
table(datos$COD_IHA)
table(datos$PRESENCIA_ZONA_NAT)
modelo_glm2_2 <- glm(PRESENCIA_HIC ~ MUCVA_ZONAS_NAT_T_ESPECIFICAS * COD_IHA * PRESENCIA_ZONA_NAT,
contrasts = list(MUCVA_ZONAS_NAT_T_ESPECIFICAS = contr.sum, COD_IHA = contr.sum),
family = binomial, data = datos)
# Probar sin contrastes
modelo_glm2_2 <- glm(PRESENCIA_HIC ~ MUCVA_ZONAS_NAT_T_ESPECIFICAS * COD_IHA * PRESENCIA_ZONA_NAT,
family = binomial, data = datos)
barplot(table(datos$PRESENCIA_HIC,datos$MUCVA_ZONAS_NAT_T_ESPECIFICAS),
legend.text = unique(datos$PRESENCIA_HIC),
args.legend = list(x = "top"),
ylab="Puntos de análisis (nº)",
main = "Presencia de HIC en función de la figura de protección")
# Categorizar como factor
datos <- subset(datos, MUCVA_ZONAS_NAT_T_ESPECIFICAS != "Mares y océanos")
# Categorizar como factor
datos <- subset(datos, MUCVA_ZONAS_NAT_T_ESPECIFICAS != "Mares y océanos") #Porque no tienen HIC aunque deberían
datos[2:9] <- lapply(datos[2:9], as.factor)
datos$CODIGO_UE2 <- lapply(datos$CODIGO_UE2, as.factor)
datos$CODIGO_UE3 <- lapply(datos$CODIGO_UE3, as.factor)
datos$CODIGO_UE4 <- lapply(datos$CODIGO_UE4, as.factor)
datos[18:33] <- lapply(datos[18:33], as.factor)
datos$PRESENCIA_ZONA_NAT<- lapply(datos$PRESENCIA_ZONA_NAT, as.factor)
datos$MUCVA_ZONAS_NAT_T_ESPECIFICAS<- lapply(datos$MUCVA_ZONAS_NAT_T_ESPECIFICAS, as.factor)
# Deshacer lista
datos$CODIGO_UE2<-unlist(datos$CODIGO_UE2)
datos$CODIGO_UE3<-unlist(datos$CODIGO_UE3)
datos$CODIGO_UE4<-unlist(datos$CODIGO_UE4)
datos$PRESENCIA_ZONA_NAT<-unlist(datos$PRESENCIA_ZONA_NAT)
datos$MUCVA_ZONAS_NAT_T_ESPECIFICAS<-unlist(datos$MUCVA_ZONAS_NAT_T_ESPECIFICAS)
# Modelo lineal generalizado binomial ##########################################
#¿Que esté protegido y su localización con respecto a la costa repercuten en si hay HIC en 2020 o no?
modelo_glm <- glm(PRESENCIA_HIC~FIGURA, family = binomial, data=datos)
Anova(modelo_glm)
summary(modelo_glm) #ENP pendiente negativa
# Sale diferencia significativa (***) en función de ENP
table(datos$PRESENCIA_HIC,datos$ENP)
barplot(table(datos$PRESENCIA_HIC,datos$FIGURA),
legend.text = unique(datos$PRESENCIA_HIC),
args.legend = list(x = "top"),
ylab="Puntos de análisis (nº)",
main = "Presencia de HIC en función de la figura de protección")
#¿El tipo de propiedad, el humedal o si hay zona natural en 1984 y el tipo de uso del suelo repercuten en si hay HIC en 2020 o no?
#...SIN INTERACCIÓN:
modelo_glm2 <- glm(PRESENCIA_HIC ~ PROPIEDAD+MUCVA_ZONAS_NAT_T_ESPECIFICAS+NOMBRE_HUM+PRESENCIA_ZONA_NAT, family = binomial, data = datos)
Anova(modelo_glm2)
barplot(table(datos$PRESENCIA_HIC,datos$MUCVA_ZONAS_NAT_T_ESPECIFICAS),
legend.text = unique(datos$PRESENCIA_HIC),
args.legend = list(x = "top"),
ylab="Puntos de análisis (nº)",
main = "Presencia de HIC en función de la figura de protección")
barplot(table(datos$PRESENCIA_HIC,datos$FIGURA),
legend=las(2),
legend.text = unique(datos$PRESENCIA_HIC),
args.legend = list(x = "top"),
ylab="Puntos de análisis (nº)",
main = "Presencia de HIC en función de la figura de protección")
barplot(table(datos$PRESENCIA_HIC,datos$FIGURA),
legend=las=2,
barplot(table(datos$PRESENCIA_HIC,datos$FIGURA),
las=2,
legend.text = unique(datos$PRESENCIA_HIC),
args.legend = list(x = "top"),
ylab="Puntos de análisis (nº)",
main = "Presencia de HIC en función de la figura de protección")
barplot(table(datos$PRESENCIA_HIC,datos$MUCVA_ZONAS_NAT_T_ESPECIFICAS),
legend.text = unique(datos$PRESENCIA_HIC),
las=2,
args.legend = list(x = "top"),
ylab="Puntos de análisis (nº)",
main = "Presencia de HIC en función de la figura de protección")
barplot(table(datos$PRESENCIA_HIC,datos$MUCVA_ZONAS_NAT_T_ESPECIFICAS),
legend.text = unique(datos$PRESENCIA_HIC),
las=4,
args.legend = list(x = "top"),
ylab="Puntos de análisis (nº)",
main = "Presencia de HIC en función de la figura de protección")
barplot(table(datos$PRESENCIA_HIC,datos$FIGURA),
las=1,
legend.text = unique(datos$PRESENCIA_HIC),
args.legend = list(x = "top"),
ylab="Puntos de análisis (nº)",
main = "Presencia de HIC en función de la figura de protección")
barplot(table(datos$PRESENCIA_HIC,datos$FIGURA),
las=3,
legend.text = unique(datos$PRESENCIA_HIC),
args.legend = list(x = "top"),
ylab="Puntos de análisis (nº)",
main = "Presencia de HIC en función de la figura de protección")
barplot(table(datos$PRESENCIA_HIC,datos$FIGURA),
las=2,
legend.text = unique(datos$PRESENCIA_HIC),
args.legend = list(x = "top"),
ylab="Puntos de análisis (nº)",
main = "Presencia de HIC en función de la figura de protección")
barplot(table(datos$PRESENCIA_HIC,datos$MUCVA_ZONAS_NAT_T_ESPECIFICAS),
legend.text = unique(datos$PRESENCIA_HIC),
las=2,
args.legend = list(x = "top"),
ylab="Puntos de análisis (nº)",
main = "Presencia de HIC en función de la figura de protección")
barplot(table(datos$PRESENCIA_HIC,datos$MUCVA_ZONAS_NAT_T_ESPECIFICAS!='Mares y oceanos'),
legend.text = unique(datos$PRESENCIA_HIC),
las=2,
args.legend = list(x = "top"),
ylab="Puntos de análisis (nº)",
main = "Presencia de HIC en función de la figura de protección")
barplot(table(datos$PRESENCIA_HIC,datos$MUCVA_ZONAS_NAT_T_ESPECIFICAS),
legend.text = unique(datos$PRESENCIA_HIC),
las=2,
args.legend = list(x = "top"),
ylab="Puntos de análisis (nº)",
main = "Presencia de HIC en función de la figura de protección")
# Categorizar como factor
datos <- subset(datos, MUCVA_ZONAS_NAT_T_ESPECIFICAS != "Mares y océanos") #Porque no tienen HIC aunque deberían
barplot(table(datos$PRESENCIA_HIC,datos$MUCVA_ZONAS_NAT_T_ESPECIFICAS),
legend.text = unique(datos$PRESENCIA_HIC),
las=2,
args.legend = list(x = "top"),
ylab="Puntos de análisis (nº)",
main = "Presencia de HIC en función de la figura de protección")
barplot(table(datos$PRESENCIA_HIC,datos$MUCVA_ZONAS_NAT_T_ESPECIFICAS),
legend.text = unique(datos$PRESENCIA_HIC),
args.legend = list(x = "top"),
ylab="Puntos de análisis (nº)",
main = "Presencia de HIC en función de la figura de protección")
# Categorizar como factor
datos <- subset(datos, MUCVA_ZONAS_NAT_T_ESPECIFICAS != "Mares y océanos") #Porque no tienen HIC aunque deberían
datos[2:9] <- lapply(datos[2:9], as.factor)
datos$CODIGO_UE2 <- lapply(datos$CODIGO_UE2, as.factor)
datos$CODIGO_UE3 <- lapply(datos$CODIGO_UE3, as.factor)
datos$CODIGO_UE4 <- lapply(datos$CODIGO_UE4, as.factor)
datos[18:33] <- lapply(datos[18:33], as.factor)
datos$PRESENCIA_ZONA_NAT<- lapply(datos$PRESENCIA_ZONA_NAT, as.factor)
datos$MUCVA_ZONAS_NAT_T_ESPECIFICAS<- lapply(datos$MUCVA_ZONAS_NAT_T_ESPECIFICAS, as.factor)
# Deshacer lista
datos$CODIGO_UE2<-unlist(datos$CODIGO_UE2)
datos$CODIGO_UE3<-unlist(datos$CODIGO_UE3)
datos$CODIGO_UE4<-unlist(datos$CODIGO_UE4)
datos$PRESENCIA_ZONA_NAT<-unlist(datos$PRESENCIA_ZONA_NAT)
datos$MUCVA_ZONAS_NAT_T_ESPECIFICAS<-unlist(datos$MUCVA_ZONAS_NAT_T_ESPECIFICAS)
# Modelo lineal generalizado binomial ##########################################
#¿Que esté protegido y su localización con respecto a la costa repercuten en si hay HIC en 2020 o no?
modelo_glm <- glm(PRESENCIA_HIC~FIGURA, family = binomial, data=datos)
Anova(modelo_glm)
barplot(table(datos$PRESENCIA_HIC,datos$MUCVA_ZONAS_NAT_T_ESPECIFICAS),
legend.text = unique(datos$PRESENCIA_HIC),
las=2,
args.legend = list(x = "top"),
ylab="Puntos de análisis (nº)",
main = "Presencia de HIC en función de los usos del suelo en 1984")
#¿Los tipos de usos del suelo (específicos) del 2020 repercuten en si hay HIC en 2020 o no? ¿Cuáles repercuten?
modelo_glm5 <- glm(PRESENCIA_HIC~datos$SIOSE_C_ES, family = binomial, data=datos)
summary(modelo_glm5)
wider<-pivot_wider(as.data.frame(table(datos$PRESENCIA_HIC,datos$SIOSE_T_ES)), names_from=Var1, values_from = Freq)
wider
summary(modelo_glm5)
barplot(table(datos$PRESENCIA_HIC,datos$GRUPO_TIPO),
legend.text = unique(datos$PRESENCIA_HIC),
las=2,
args.legend = list(x = "top"),
ylab="Puntos de análisis (nº)",
main = "Presencia de HIC en función de los usos del suelo en 1984")
barplot(table(datos$PRESENCIA_HIC,datos$ZONA),
legend.text = unique(datos$PRESENCIA_HIC),
las=2,
args.legend = list(x = "top"),
ylab="Puntos de análisis (nº)",
main = "Presencia de HIC en función de los usos del suelo en 1984")
barplot(table(datos$PRESENCIA_HIC,datos$ZONA),
legend.text = unique(datos$PRESENCIA_HIC),
las=2,
args.legend = list(x = "topRIGHT"),
ylab="Puntos de análisis (nº)",
main = "Presencia de HIC en función de los usos del suelo en 1984")
barplot(table(datos$PRESENCIA_HIC,datos$ZONA),
legend.text = unique(datos$PRESENCIA_HIC),
las=2,
args.legend = list(x = "topright"),
ylab="Puntos de análisis (nº)",
main = "Presencia de HIC en función de los usos del suelo en 1984")
#   Buffer Humedal
#0   1013     375
#1    496     196
#Se puede ver como hay menor presencia de HIC en el buffer
barplot(table(datos$PRESENCIA_HIC,datos$ZONA),
legend.text = unique(datos$PRESENCIA_HIC),
las=2,
args.legend = list(x = "topright"),
ylab="Puntos de análisis (nº)",
main = "Presencia de HIC en función si es zona de humedal o buffer")
#   Buffer Humedal
#0   1013     375
#1    496     196
#Se puede ver como hay menor presencia de HIC en el buffer
barplot(table(datos$PRESENCIA_HIC,datos$ZONA),
legend.text = unique(datos$PRESENCIA_HIC),
las=2,
args.legend = list(x = "topright"),
ylab="Puntos de análisis (nº)",
main = "Presencia de HIC en función la situación con respecto al humedal")
#   Buffer Humedal
#0   1013     375
#1    496     196
#Se puede ver como hay menor presencia de HIC en el buffer
barplot(table(datos$PRESENCIA_HIC,datos$ZONA),
legend.text = unique(datos$PRESENCIA_HIC),
las=2,
args.legend = list(x = "topright"),
ylab="Puntos de análisis (nº)",
main = "Presencia de HIC en función de la situación con respecto al humedal")
#   Buffer Humedal
#0   1013     375
#1    496     196
#Se puede ver como hay menor presencia de HIC en el buffer
boxplot(table(datos$PRESENCIA_HIC,datos$ZONA),
legend.text = unique(datos$PRESENCIA_HIC),
las=2,
args.legend = list(x = "topright"),
ylab="Puntos de análisis (nº)",
main = "Presencia de HIC en función de la situación con respecto al humedal")
#   Buffer Humedal
#0   1013     375
#1    496     196
#Se puede ver como hay menor presencia de HIC en el buffer
boxplot(datos$PRESENCIA_HIC,datos$ZONA,
legend.text = unique(datos$PRESENCIA_HIC),
las=2,
args.legend = list(x = "topright"),
ylab="Puntos de análisis (nº)",
main = "Presencia de HIC en función de la situación con respecto al humedal")
#¿Los tipos de usos del suelo (específicos) 1984/2020 repercuten en si hay HIC en 2020 o no? ¿Cuáles repercuten?
#...CON INTERACCIÓN: * y contrasts=list()
modelo_glm3 <- glm(PRESENCIA_HIC~datos$MUCVA_C_ES*SIOSE_C_ES, contrasts=list(MUCVA_T_ES=contr.sum,SIOSE_T_ES=contr.sum), family = binomial, data=datos)
summary(modelo_glm3)
# Cargar las librerías
library(readxl)
library(car) #Anova()
library(multcomp) # Tukey
# Leer los archivos
setwd("D:/Escritorio/TFM/rTFM")
datos <-read_excel("Excel/puntos_hic_zonas_naturales.xlsx", sheet = 1)
# Categorizar como factor
datos <- subset(datos, MUCVA_ZONAS_NAT_T_ESPECIFICAS != "Mares y océanos") #Porque no tienen HIC aunque deberían
datos <-read_excel("Excel/puntos_hic_zonas_naturales.xlsx", sheet = 1)
# Categorizar como factor
#datos <- subset(datos, MUCVA_ZONAS_NAT_T_ESPECIFICAS != "Mares y océanos") #Porque no tienen HIC aunque deberían
datos[2:9] <- lapply(datos[2:9], as.factor)
datos$CODIGO_UE2 <- lapply(datos$CODIGO_UE2, as.factor)
datos$CODIGO_UE3 <- lapply(datos$CODIGO_UE3, as.factor)
datos$CODIGO_UE4 <- lapply(datos$CODIGO_UE4, as.factor)
datos[18:33] <- lapply(datos[18:33], as.factor)
datos$PRESENCIA_ZONA_NAT<- lapply(datos$PRESENCIA_ZONA_NAT, as.factor)
datos$MUCVA_ZONAS_NAT_T_ESPECIFICAS<- lapply(datos$MUCVA_ZONAS_NAT_T_ESPECIFICAS, as.factor)
# Deshacer lista
datos$CODIGO_UE2<-unlist(datos$CODIGO_UE2)
datos$CODIGO_UE3<-unlist(datos$CODIGO_UE3)
datos$CODIGO_UE4<-unlist(datos$CODIGO_UE4)
datos$PRESENCIA_ZONA_NAT<-unlist(datos$PRESENCIA_ZONA_NAT)
datos$MUCVA_ZONAS_NAT_T_ESPECIFICAS<-unlist(datos$MUCVA_ZONAS_NAT_T_ESPECIFICAS)
# Modelo lineal generalizado binomial ##########################################
#¿Que esté protegido y su localización con respecto a la costa repercuten en si hay HIC en 2020 o no?
modelo_glm <- glm(PRESENCIA_HIC~FIGURA, family = binomial, data=datos)
Anova(modelo_glm)
summary(modelo_glm) #ENP pendiente negativa
# Sale diferencia significativa (***) en función de ENP
table(datos$PRESENCIA_HIC,datos$ENP)
barplot(table(datos$PRESENCIA_HIC,datos$FIGURA),
las=2,
legend.text = unique(datos$PRESENCIA_HIC),
args.legend = list(x = "top"),
ylab="Puntos de análisis (nº)",
main = "Presencia de HIC en función de la figura de protección")
#¿El tipo de propiedad, el humedal o si hay zona natural en 1984 y el tipo de uso del suelo repercuten en si hay HIC en 2020 o no?
#...SIN INTERACCIÓN:
modelo_glm2 <- glm(PRESENCIA_HIC ~ PROPIEDAD+MUCVA_ZONAS_NAT_T_ESPECIFICAS+NOMBRE_HUM+PRESENCIA_ZONA_NAT, family = binomial, data = datos)
Anova(modelo_glm2)
#...CON INTERACCIÓN: * y contrasts=list(), también he eliminado PROPIEDAD, porque no era significativo
modelo_glm2_2 <- glm(PRESENCIA_HIC ~ MUCVA_ZONAS_NAT_T_ESPECIFICAS*COD_IHA*PRESENCIA_ZONA_NAT, contrasts=list(MUCVA_ZONAS_NAT_T_ESPECIFICAS=contr.sum,COD_IHA=contr.sum), family = binomial, data = datos)
Anova(modelo_glm2_2) #tarda mucho
barplot(table(datos$PRESENCIA_HIC,datos$MUCVA_ZONAS_NAT_T_ESPECIFICAS),
legend.text = unique(datos$PRESENCIA_HIC),
las=2,
args.legend = list(x = "top"),
ylab="Puntos de análisis (nº)",
main = "Presencia de HIC en función de los usos del suelo en 1984")
# Verificar el número de niveles en cada variable
summary(datos$PROPIEDAD)  # Ejemplo para la variable PROPIEDAD
summary(datos$MUCVA_ZONAS_NAT_T_ESPECIFICAS)  # Otra variable categórica
summary(datos$NOMBRE_HUM)
summary(datos$PRESENCIA_ZONA_NAT)
#¿Los tipos de usos del suelo (específicos) 1984/2020 repercuten en si hay HIC en 2020 o no? ¿Cuáles repercuten?
#...CON INTERACCIÓN: * y contrasts=list()
modelo_glm3 <- glm(PRESENCIA_HIC~datos$MUCVA_C_ES*SIOSE_C_ES, contrasts=list(MUCVA_T_ES=contr.sum,SIOSE_T_ES=contr.sum), family = binomial, data=datos)
summary(modelo_glm3)
#...SIN INTERACCIÓN:
modelo_glm4 <- glm(PRESENCIA_HIC~datos$MUCVA_C_ES+SIOSE_C_ES, family = binomial, data=datos)
summary(modelo_glm4)
summary(modelo_glm3)
View(summary(modelo_glm3))
View(as.table(summary(modelo_glm3)))
str(summary(modelo_glm3))
summary(modelo_glm3)$cov.scaled
summary(modelo_glm3)$cov.scaled-attr
# Ajustar el modelo
modelo_glm3 <- glm(PRESENCIA_HIC ~ MUCVA_C_ES * SIOSE_C_ES,
contrasts = list(MUCVA_T_ES = contr.sum, SIOSE_T_ES = contr.sum),
family = binomial, data = datos)
# Extraer el resumen del modelo
resumen_modelo <- summary(modelo_glm3)
# Extraer los coeficientes, errores estándar, z-value y p-value
coefs <- resumen_modelo$coefficients
# Filtrar las filas significativas (p < 0.05)
significativos <- coefs[coefs[, 4] < 0.05, ]
# Crear un data.frame con las categorías significativas y sus valores
tabla_significativos <- data.frame(
Termino = rownames(significativos),
Coeficiente = significativos[, 1],
Error_Estandar = significativos[, 2],
Z_value = significativos[, 3],
P_value = significativos[, 4]
)
# Mostrar la tabla de valores significativos
print(tabla_significativos)
# Extraer el resumen del modelo
resumen_modelo <- summary(modelo_glm3)
# Extraer los coeficientes, errores estándar, z-value y p-value
coefs <- resumen_modelo$coefficients
# Filtrar las filas significativas (p < 0.05)
significativos <- coefs[coefs[, 4] < 0.05, ]
# Crear un data.frame con las categorías significativas y sus valores
tabla_significativos <- data.frame(
Termino = rownames(significativos),
Coeficiente = significativos[, 1],
Error_Estandar = significativos[, 2],
Z_value = significativos[, 3],
P_value = significativos[, 4]
)
# Mostrar la tabla de valores significativos
print(tabla_significativos)
View(tabla_significativos)
# Extraer los coeficientes, errores estándar, z-value y p-value
# Extraer los coeficientes, errores estándar, z-value y p-value
coefs <- resumen_modelo$coefficients
# Filtrar las filas significativas (p < 0.05)
significativos <- coefs[coefs[, 4] < 0.05, ]
# Asignar asteriscos según el nivel de significancia
significancia <- cut(significativos[, 4],
breaks = c(0, 0.001, 0.01, 0.05, 1),
labels = c("***", "**", "*", ""))
# Crear un data.frame con las categorías significativas, coeficientes y p-valores con asteriscos
tabla_significativos <- data.frame(
Termino = rownames(significativos),
Coeficiente = round(significativos[, 1], 4),  # Redondeado a 4 decimales para mejor legibilidad
Error_Estandar = round(significativos[, 2], 4),
Z_value = round(significativos[, 3], 4),
P_value = round(significativos[, 4], 4),
Significancia = significancia
)
# Mostrar la tabla de valores significativos
print(tabla_significativos)
View(tabla_significativos)
summary(modelo_glm4)
str(summary(modelo_glm4))
summary(modelo_glm4)$cov.scaled
summary(modelo_glm3)
getOption("max.print")
getOption("max.print"=1200)
?options(max.print)
?getOptions(max.print)
??getOptions()
options(max.print=1500)
summary(modelo_glm3)
options(max.print=2000)
summary(modelo_glm3)
#¿Los tipos de usos del suelo (generales) 1984/2020 repercuten en si hay HIC en 2020 o no?  ¿Cuáles repercuten?
modelo_glm6 <- glm(PRESENCIA_HIC~datos$MUCVA_C_GE:SIOSE_C_GE, family = binomial, data=datos)
summary(modelo_glm6)
unique(datos$MUCVA_T_GE)
#¿El tipo de propiedad, el humedal o si hay zona natural en 1984 y el tipo de uso del suelo repercuten en si hay HIC en 2020 o no?
#...SIN INTERACCIÓN:
modelo_glm2 <- glm(PRESENCIA_HIC ~ PROPIEDAD+MUCVA_ZONAS_NAT_T_ESPECIFICAS+NOMBRE_HUM+PRESENCIA_ZONA_NAT, family = binomial, data = datos)
Anova(modelo_glm2)
datos <-read_excel("Excel/puntos_hic_zonas_naturales.xlsx", sheet = 1)
# Categorizar como factor
#datos <- subset(datos, MUCVA_ZONAS_NAT_T_ESPECIFICAS != "Mares y océanos") #Porque no tienen HIC aunque deberían
datos[2:9] <- lapply(datos[2:9], as.factor)
#¿El tipo de propiedad, el humedal o si hay zona natural en 1984 y el tipo de uso del suelo repercuten en si hay HIC en 2020 o no?
#...SIN INTERACCIÓN:
modelo_glm2 <- glm(PRESENCIA_HIC ~ PROPIEDAD+MUCVA_ZONAS_NAT_T_ESPECIFICAS+NOMBRE_HUM+PRESENCIA_ZONA_NAT, family = binomial, data = datos)
Anova(modelo_glm2)
summary(modelo_glm2)
unique(datos$PROPIEDAD)
#¿El tipo de propiedad, el humedal o si hay zona natural en 1984 y el tipo de uso del suelo repercuten en si hay HIC en 2020 o no?
#...SIN INTERACCIÓN:
modelo_glm2 <- glm(PRESENCIA_HIC ~ MUCVA_ZONAS_NAT_T_ESPECIFICAS+NOMBRE_HUM+PRESENCIA_ZONA_NAT, family = binomial, data = datos)
summary(modelo_glm2)
#¿Los tipos de usos del suelo (específicos) 1984/2020 repercuten en si hay HIC en 2020 o no? ¿Cuáles repercuten?
#...CON INTERACCIÓN: * y contrasts=list()
modelo_glm3 <- glm(PRESENCIA_HIC~datos$MUCVA_C_ES*SIOSE_C_ES, contrasts=list(MUCVA_T_ES=contr.sum,SIOSE_T_ES=contr.sum), family = binomial, data=datos)
summary(modelo_glm3)
#...SIN INTERACCIÓN:
modelo_glm4 <- glm(PRESENCIA_HIC~datos$MUCVA_C_ES+SIOSE_C_ES, family = binomial, data=datos)
summary(modelo_glm4)
Anova(modelo_glm4)
#¿Los tipos de usos del suelo (específicos) del 2020 repercuten en si hay HIC en 2020 o no? ¿Cuáles repercuten?
modelo_glm5 <- glm(PRESENCIA_HIC~datos$SIOSE_C_ES, family = binomial, data=datos)
summary(modelo_glm5)
wider<-pivot_wider(as.data.frame(table(datos$PRESENCIA_HIC,datos$SIOSE_T_ES)), names_from=Var1, values_from = Freq)
wider
# Categorizar como factor
#datos <- subset(datos, MUCVA_ZONAS_NAT_T_ESPECIFICAS != "Mares y océanos") #Porque no tienen HIC aunque deberían
datos[2:9] <- lapply(datos[2:9], as.factor)
datos$CODIGO_UE2 <- lapply(datos$CODIGO_UE2, as.factor)
datos$CODIGO_UE3 <- lapply(datos$CODIGO_UE3, as.factor)
datos$CODIGO_UE4 <- lapply(datos$CODIGO_UE4, as.factor)
datos[18:33] <- lapply(datos[18:33], as.factor)
datos$PRESENCIA_ZONA_NAT<- lapply(datos$PRESENCIA_ZONA_NAT, as.factor)
datos$MUCVA_ZONAS_NAT_T_ESPECIFICAS<- lapply(datos$MUCVA_ZONAS_NAT_T_ESPECIFICAS, as.factor)
# Deshacer lista
datos$CODIGO_UE2<-unlist(datos$CODIGO_UE2)
datos$CODIGO_UE3<-unlist(datos$CODIGO_UE3)
datos$CODIGO_UE4<-unlist(datos$CODIGO_UE4)
datos$PRESENCIA_ZONA_NAT<-unlist(datos$PRESENCIA_ZONA_NAT)
datos$MUCVA_ZONAS_NAT_T_ESPECIFICAS<-unlist(datos$MUCVA_ZONAS_NAT_T_ESPECIFICAS)
#¿Los tipos de usos del suelo (específicos) 1984/2020 repercuten en si hay HIC en 2020 o no? ¿Cuáles repercuten?
#...CON INTERACCIÓN: * y contrasts=list()
modelo_glm3 <- glm(PRESENCIA_HIC~datos$MUCVA_C_ES*SIOSE_C_ES, contrasts=list(MUCVA_T_ES=contr.sum,SIOSE_T_ES=contr.sum), family = binomial, data=datos)
#¿Los tipos de usos del suelo (generales) 1984/2020 repercuten en si hay HIC en 2020 o no?  ¿Cuáles repercuten?
modelo_glm6 <- glm(PRESENCIA_HIC~datos$MUCVA_C_GE:SIOSE_C_GE, family = binomial, data=datos)
summary(modelo_glm6)
#¿Los tipos de usos del suelo (generales) 1984/2020 repercuten en si hay HIC en 2020 o no?  ¿Cuáles repercuten?
modelo_glm6 <- glm(PRESENCIA_HIC~datos$MUCVA_C_GE, family = binomial, data=datos)
summary(modelo_glm6)
modelo_glm6_2 <- glm(PRESENCIA_HIC~datos$SIOSE_C_GE, family = binomial, data=datos)
summary(modelo_glm6_2)
#¿Los tipos de usos del suelo (específicos) del 2020 repercuten en si hay HIC en 2020 o no? ¿Cuáles repercuten?
modelo_glm5 <- glm(PRESENCIA_HIC~datos$SIOSE_C_ES, family = binomial, data=datos)
summary(modelo_glm5)
#¿Los tipos de usos del suelo (específicos) del 2020 repercuten en si hay HIC en 2020 o no? ¿Cuáles repercuten?
modelo_glm5 <- glm(PRESENCIA_HIC~datos$MUCVA_C_ES, family = binomial, data=datos)
summary(modelo_glm5)
modelo_glm5_2 <- glm(PRESENCIA_HIC~datos$SIOSE_C_ES, family = binomial, data=datos)
summary(modelo_glm5_2)
summary(modelo_glm5)
